(this["webpackJsonplaundry-app"]=this["webpackJsonplaundry-app"]||[]).push([[0],{66:function(e,t,a){},68:function(e,t,a){},71:function(e,t,a){},74:function(e,t,a){},86:function(e,t,a){"use strict";a.r(t);var n=a(3),c=a(2),s=a.n(c),r=a(22),i=a.n(r),o=a(21),l=a(11),d=a(18),j=a(14),u="user/SET_USER_DATA",h={user:{}},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:return Object(j.a)(Object(j.a)({},e),{},{user:t.payload.data});default:return e}},m=function(e){return{type:u,payload:{data:e}}},O=a(12),x=a(89),f=a(56).a.initializeApp({apiKey:"AIzaSyDF6_nwZ3S0DOqQfQmotDsK57KSaQ4MkbA",authDomain:"laundry-sky.firebaseapp.com",databaseURL:"https://laundry-sky.firebaseio.com",projectId:"laundry-sky",storageBucket:"laundry-sky.appspot.com",messagingSenderId:"928149548505",appId:"1:928149548505:web:a669c34c03511b072ebdc8"});a(48),a(66);var p=function(){var e=Object(d.b)(),t=Object(l.f)(),a=Object(c.useState)(!1),s=Object(O.a)(a,2),r=s[0],i=s[1],j=Object(c.useState)(""),u=Object(O.a)(j,2),h=u[0],b=u[1],p=Object(c.useState)(""),g=Object(O.a)(p,2),w=g[0],v=g[1],N=f.firestore(),y=Object(c.useCallback)((function(){i(!0),f.auth().signInWithEmailAndPassword(h,w).then((function(){N.collection("users").where("id","==",f.auth().currentUser.uid).get().then((function(a){a.forEach((function(a){e(m(a.data())),localStorage.setItem("laundrySky@user",JSON.stringify(a.data())),t.push("/home")}))})).catch((function(){i(!1)}))})).catch((function(){i(!1)}))}),[h,w,N,e,t]);return Object(n.jsx)("div",{className:"login-content d-flex align-items-center",children:Object(n.jsxs)("form",{className:"form-signin mx-auto",children:[Object(n.jsx)("div",{className:"text-center mb-4",children:Object(n.jsx)("h1",{className:"h3 mb-3 font-weight-normal text-white font-weight-bold",children:"Login"})}),Object(n.jsx)("input",{type:"email",id:"inputEmail",value:h,onChange:function(e){return b(e.target.value)},className:"form-control my-2",placeholder:"Email"}),Object(n.jsx)("input",{type:"password",value:w,onChange:function(e){return v(e.target.value)},id:"inputPassword",className:"form-control my-2",placeholder:"Senha"}),r?Object(n.jsx)(x.a,{animation:"border",variant:"light"}):Object(n.jsx)("button",{className:"btn btn-lg btn-primary btn-block btn-login",type:"button",onClick:y,children:"Entrar"}),Object(n.jsxs)("div",{className:"login-options mt-5 text-center",children:[Object(n.jsx)(o.b,{to:"/signup",className:"mx-2",children:"Criar Conta"}),Object(n.jsx)("span",{className:"text-white",children:"\u2605"}),Object(n.jsx)("a",{href:"#",className:"mx-2",children:"Recuperar Senha"})]})]})})},g=a(33),w=a(92),v=a(90),N=a(94),y=a(23);a(47),a(68);var C=function(){var e=Object(c.useState)({}),t=Object(O.a)(e,2),a=t[0],s=t[1],r=Object(c.useState)(!1),i=Object(O.a)(r,2),o=i[0],u=i[1],h=Object(d.b)(),b=f.firestore(),p=Object(l.f)(),C=Object(c.useCallback)((function(e){e.preventDefault();var t=a.name,n=a.email,c=a.password,s=a.unit;"skystudios@2020"!==a.adminPassword?y.b.error("Senha do administrador incorreta"):(u(!0),f.auth().createUserWithEmailAndPassword(n,c).then((function(e){b.collection("users").add({id:e.user.uid,name:t,email:n,unit:s,created:new Date}),h(m({name:t,email:n,unit:s})),u(!1),p.push("/home")})).catch((function(e){u(!1),"auth/email-already-in-use"===e.code?y.b.warn("Email j\xe1 cadastrado, por favor utilize outro"):"auth/weak-passwordc"===e.code&&y.b.warn("A senha deve conter mais de 6 digitos")})))}),[a,b]),S=function(e){s(Object(j.a)(Object(j.a)({},a),{},Object(g.a)({},e.target.name,e.target.value)))};return Object(n.jsx)("div",{className:"login-content d-flex align-items-center",children:Object(n.jsxs)(w.a,{className:"mx-auto",children:[Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Nome"}),Object(n.jsx)(w.a.Control,{value:a.name,onChange:S,name:"name",type:"text",placeholder:"Seu nome"})]}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Email"}),Object(n.jsx)(w.a.Control,{value:a.email,onChange:S,name:"email",type:"email",placeholder:"Seu email"})]}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Senha"}),Object(n.jsx)(w.a.Control,{value:a.password,onChange:S,name:"password",type:"password",placeholder:"Senha"})]}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Confirma\xe7\xe3o da Senha"}),Object(n.jsx)(w.a.Control,{value:a.passwordConfirmation,onChange:S,name:"passwordConfirmation",type:"password",placeholder:"Senha"})]}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Unidade"}),Object(n.jsx)(w.a.Control,{value:a.unit,onChange:S,name:"unit",type:"text",placeholder:"N\xfamero do seu apartamento"})]}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Senha do admin"}),Object(n.jsx)(w.a.Control,{value:a.adminPassword,onChange:S,name:"adminPassword",type:"password",placeholder:"Senha do admin"})]}),Object(n.jsx)(w.a.Group,{as:v.a,children:o?Object(n.jsx)(x.a,{animation:"border",variant:"light"}):Object(n.jsx)(N.a,{variant:"primary",type:"button",onClick:C,children:"Cadastrar"})})]})})},S=a(43),k=a(93),_=a(91),L=a(25),D=a.n(L);a(71);var E=function(){var e=Object(d.c)((function(e){return e.user})).user,t=Object(c.useState)([]),a=Object(O.a)(t,2),s=a[0],r=a[1],i=Object(c.useState)([]),o=Object(O.a)(i,2),u=o[0],h=o[1],b=Object(c.useState)(!1),m=Object(O.a)(b,2),x=m[0],p=m[1],g=Object(c.useState)(!1),w=Object(O.a)(g,2),v=w[0],y=w[1],C=Object(l.f)(),L=f.firestore(),E=Object(c.useCallback)((function(){L.collection("washes").where("machine","==",1).get().then((function(e){e.docs.length&&e.forEach((function(e){L.collection("users").get().then((function(t){var a=t.docs.find((function(t){return t.data().id===e.data().user}));r((function(t){return[].concat(Object(S.a)(t),[Object(j.a)({date:"".concat(D()(e.data().created.toDate()).format("DD/MM/YYYY")," as ").concat(D()(e.data().created.toDate()).format("HH:mm")),userParsed:a.data()},e.data())])}))}))}))}))}),[L]),H=Object(c.useCallback)((function(){h([]),L.collection("washes").where("machine","==",2).get().then((function(e){e.docs.length&&e.forEach((function(e){L.collection("users").get().then((function(t){var a=t.docs.find((function(t){return t.data().id===e.data().user}));h((function(t){return[].concat(Object(S.a)(t),[Object(j.a)({date:"".concat(D()(e.data().created.toDate()).format("DD/MM/YYYY")," as ").concat(D()(e.data().created.toDate()).format("HH:mm")),userParsed:a.data()},e.data())])}))}))}))}))}),[L]),I=Object(c.useCallback)((function(){L.collection("machines").get().then((function(e){e.docs.length&&e.docs.forEach((function(e){var t=e.data();1===t.code?p(t.in_use):2===t.code&&y(t.in_use)}))}))}),[L]);return Object(c.useEffect)((function(){var e=L.collection("washes").onSnapshot((function(){H(),E()})),t=L.collection("machines").onSnapshot((function(){I()}));return function(){t(),e()}}),[]),Object(n.jsxs)("div",{className:"home-container pt-5",children:[Object(n.jsx)("div",{className:"button-wash-container mb-3",children:Object(n.jsx)(N.a,{variant:"success",onClick:function(){return C.push("wash/start")},children:"Iniciar Lavagem"})}),x&&s.find((function(t){return t.user===e.id}))?Object(n.jsx)("div",{className:"button-wash-container mb-3",children:Object(n.jsx)(N.a,{variant:"primary",onClick:function(){return C.push("wash/pause/1")},children:"Parar Lavagem na Maquina 1"})}):null,v&&u.find((function(t){return t.user===e.id}))?Object(n.jsx)("div",{className:"button-wash-container mb-3",children:Object(n.jsx)(N.a,{variant:"primary",onClick:function(){return C.push("wash/pause/2")},children:"Parar Lavagem na Maquina 2"})}):null,Object(n.jsxs)(k.a,{className:"home-cards mx-auto",children:[Object(n.jsxs)(k.a.Header,{children:["Maquina 01 ",x?" - Em uso":" - Dispon\xedvel para uso"]}),Object(n.jsx)(k.a.Body,{children:Object(n.jsxs)(_.a,{striped:!0,bordered:!0,hover:!0,children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{className:"text-center",children:"Unidade"}),Object(n.jsx)("th",{className:"text-center",children:"Data"}),Object(n.jsx)("th",{className:"text-center",children:"Registro Inicial KWH"}),Object(n.jsx)("th",{className:"text-center",children:"Registro Final KWH"}),Object(n.jsx)("th",{className:"text-center",children:"Registro Inicial Hidr\xf4metro"}),Object(n.jsx)("th",{className:"text-center",children:"Registro Final Hidr\xf4metro"}),Object(n.jsx)("th",{className:"text-center",children:"Usu\xe1rio"})]})}),Object(n.jsx)("tbody",{children:s.length?s.map((function(e,t){return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{className:"text-center",children:e.userParsed.unit}),Object(n.jsx)("td",{className:"text-center",children:e.date}),Object(n.jsx)("td",{className:"text-center",children:e.initial_kwh}),Object(n.jsx)("td",{className:"text-center",children:e.final_kwh||""}),Object(n.jsx)("td",{className:"text-center",children:e.initial_water}),Object(n.jsx)("td",{className:"text-center",children:e.final_water||""}),Object(n.jsx)("td",{className:"text-center",children:e.userParsed.name})]},t)})):null})]})})]}),Object(n.jsxs)(k.a,{className:"home-cards mx-auto mt-5",children:[Object(n.jsxs)(k.a.Header,{children:["Maquina 02 ",v?" - Em uso":" - Dispon\xedvel para uso"]}),Object(n.jsx)(k.a.Body,{children:Object(n.jsxs)(_.a,{striped:!0,bordered:!0,hover:!0,children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{className:"text-center",children:"Unidade"}),Object(n.jsx)("th",{className:"text-center",children:"Data"}),Object(n.jsx)("th",{className:"text-center",children:"Registro Inicial KWH"}),Object(n.jsx)("th",{className:"text-center",children:"Registro Final KWH"}),Object(n.jsx)("th",{className:"text-center",children:"Registro Inicial Hidr\xf4metro"}),Object(n.jsx)("th",{className:"text-center",children:"Registro Final Hidr\xf4metro"}),Object(n.jsx)("th",{className:"text-center",children:"Usu\xe1rio"})]})}),Object(n.jsx)("tbody",{children:u.map((function(e,t){return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{className:"text-center",children:e.userParsed.unit}),Object(n.jsx)("td",{className:"text-center",children:e.date}),Object(n.jsx)("td",{className:"text-center",children:e.initial_kwh}),Object(n.jsx)("td",{className:"text-center",children:e.final_kwh||""}),Object(n.jsx)("td",{className:"text-center",children:e.initial_water}),Object(n.jsx)("td",{className:"text-center",children:e.final_water||""}),Object(n.jsx)("td",{className:"text-center",children:e.userParsed.name})]},t)}))})]})})]})]})};var H=function(){var e=Object(d.c)((function(e){return e.user})).user,t=f.firestore(),a=Object(l.f)(),s=Object(c.useState)(!1),r=Object(O.a)(s,2),i=r[0],o=r[1],j=Object(c.useState)({final_kwh:"",final_water:""}),u=Object(O.a)(j,2),h=u[0],b=u[1],m=Object(c.useState)(1),p=Object(O.a)(m,2),g=p[0],C=p[1],S=Object(c.useState)([]),k=Object(O.a)(S,2),_=k[0],L=k[1],E=Object(c.useCallback)((function(){var e=[];t.collection("machines").get().then((function(t){t.docs.length&&t.docs.forEach((function(t){e.push(t.data())})),L(e)}))}),[t]);return Object(c.useEffect)((function(){t.collection("washes").where("machine","==",parseInt(g)).orderBy("created","desc").limit(1).get().then((function(e){e.docs.length?e.forEach((function(e){b(e.data())})):b({final_kwh:"",final_water:""})}))}),[g,t]),Object(c.useEffect)((function(){var e=t.collection("machines").onSnapshot((function(){E()}));return function(){e()}}),[t]),Object(n.jsx)("div",{className:"login-content d-flex align-items-center",children:Object(n.jsxs)(w.a,{className:"mx-auto",children:[Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Selecione o n\xfamero da maquina"}),Object(n.jsx)(w.a.Control,{value:g,as:"select",onChange:function(e){return C(e.target.value)},children:_.map((function(e){return Object(n.jsxs)("option",{value:e.code,children:[" ",e.name," ",e.in_use?"(em uso)":"(livre)"]},e.code)}))})]}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Data"}),Object(n.jsx)(w.a.Control,{value:D()().format("DD/MM/YYYY HH:mm"),onChange:function(){},name:"created",type:"text",disabled:!0})]}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Registro Inicial KWH"}),Object(n.jsx)(w.a.Control,{value:h.final_kwh,onChange:function(){},placeholder:"Consumo inicial em KWH",name:"initial_kwh",type:"text",disabled:!0})]}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Registro Inicial Hidr\xf4metro"}),Object(n.jsx)(w.a.Control,{value:h.final_water,onChange:function(){},name:"passwordConfirmation",type:"text",disabled:!0,placeholder:"Consumo inicial hidr\xf4metro"})]}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Usu\xe1rio"}),Object(n.jsx)(w.a.Control,{value:e.unit,onChange:function(){},name:"unit",type:"text",placeholder:"N\xfamero do seu apartamento",disabled:!0})]}),Object(n.jsx)(w.a.Group,{as:v.a,children:i?Object(n.jsx)(x.a,{animation:"border",variant:"light"}):Object(n.jsx)(N.a,{variant:"primary",type:"button",onClick:function(){o(!0),t.collection("washes").add({initial_kwh:h.final_kwh,initial_water:h.final_water,user:e.id,machine:parseInt(g),created:new Date}).then((function(){t.collection("machines").where("code","==",parseInt(g)).get().then((function(e){e.docs.length&&e.docs[0].ref.update({in_use:!0}),o(!1),y.b.success("Lavagem iniciada com sucesso"),setTimeout((function(){a.push("/home")}),1500)})).catch((function(){o(!1)}))})).catch((function(){o(!1)}))},children:"Confirmar Inicio"})})]})})};var I=function(){var e=Object(c.useState)(!1),t=Object(O.a)(e,2),a=t[0],s=t[1],r=Object(l.f)(),i=f.firestore(),o=Object(l.g)().id,d=Object(c.useState)({final_kwh:"",final_water:""}),u=Object(O.a)(d,2),h=u[0],b=u[1];return Object(n.jsx)("div",{className:"login-content d-flex",children:Object(n.jsxs)(w.a,{className:"mx-auto",children:[Object(n.jsx)("div",{className:"mb-5",children:Object(n.jsxs)("h2",{className:"text-white",children:["Pausar Lavagem na Maquina ",o]})}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Registro Final KWH"}),Object(n.jsx)(w.a.Control,{value:h.final_kwh,onChange:function(e){return b(Object(j.a)(Object(j.a)({},h),{},{final_kwh:e.target.value}))},placeholder:"Consumo final em KWH",type:"text"})]}),Object(n.jsxs)(w.a.Group,{as:v.a,children:[Object(n.jsx)(w.a.Label,{className:"text-white",children:"Registro Final Hidr\xf4metro"}),Object(n.jsx)(w.a.Control,{value:h.final_water,onChange:function(e){return b(Object(j.a)(Object(j.a)({},h),{},{final_water:e.target.value}))},type:"text",placeholder:"Consumo final do hidr\xf4metro"})]}),Object(n.jsx)(w.a.Group,{as:v.a,children:a?Object(n.jsx)(x.a,{animation:"border",variant:"light"}):Object(n.jsx)(N.a,{variant:"primary",type:"button",onClick:function(){s(!0),i.collection("washes").where("machine","==",parseInt(o)).orderBy("created","desc").limit(1).get().then((function(e){e.docs.length&&e.docs[0].ref.update({final_kwh:h.final_kwh,final_water:h.final_water,updated:new Date}).then((function(){i.collection("machines").where("code","==",parseInt(o)).get().then((function(e){e.docs.length&&e.docs[0].ref.update({in_use:!1}),y.b.success("Lavagem pausada com sucesso"),setTimeout((function(){r.push("/home")}),1500),s(!1)})).catch((function(){s(!1)}))})).catch((function(){s(!1)}))}))},children:"Confirmar Fim da Lavagem"})})]})})};var G=function(){var e=Object(d.b)();return Object(c.useEffect)((function(){var t=localStorage.getItem("laundrySky@user");t&&e(m(JSON.parse(t)))}),[e]),Object(n.jsxs)(l.c,{children:[Object(n.jsx)(l.a,{exact:!0,path:"/",children:Object(n.jsx)(p,{})}),Object(n.jsx)(l.a,{path:"/signup",children:Object(n.jsx)(C,{})}),Object(n.jsx)(l.a,{path:"/home",children:Object(n.jsx)(E,{})}),Object(n.jsx)(l.a,{path:"/wash/start",children:Object(n.jsx)(H,{})}),Object(n.jsx)(l.a,{path:"/wash/pause/:id",children:Object(n.jsx)(I,{})})]})};a(72),a(73),a(74);var P=function(){return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(y.a,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),Object(n.jsx)(o.a,{children:Object(n.jsx)(G,{})})]})},R=a(27),M=a(42),Y=a.n(M),K=a(55),A=Y.a.configure({name:"Laundry Sky Studios"}).use(Object(K.reactotronRedux)()).connect(),U=console.log;console.log=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];U.apply(void 0,t),Y.a.display({name:"CONSOLE.LOG",value:t,preview:t.length>0&&"string"===typeof t[0]?t[0]:null})};var W=A,F=Object(R.b)({user:b}),q=Object(R.c)(F,W.createEnhancer());i.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(d.a,{store:q,children:Object(n.jsx)(P,{})})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.61bf5f04.chunk.js.map